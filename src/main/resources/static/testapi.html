<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
<title>Insert title here</title>
</head>
<body>
	<h2>Article Rest Api Test</h2>
	<ul>
		<li><a id="getlist" href="/api/articles">목록 조회</a></li>
		<li><a id="get"     href="/api/articles/2">한개 조회</a></li>
		<li><a id="post"    href="/api/articles/">추가</a></li>
		<li><a id="patch"   href="/api/articles/2">수정</a></li>
		<li><a id="delete"  href="/api/articles/2">삭제</a></li>
	</ul>
	
	<h3>결과</h3>
	<div id="result" style="margin-bottom:150px"></div>
	
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
	
	<script>
		function makeTable( list ) {
			let table = '<table class="table table-striped mx-auto" style="width:90%">'
			table    += '<tr class="table-dark">'
			table    += `<th>#</th>`
			table    += `<th>Title</th>`
			table    += `<th>Content</th>`
			table    += '</tr>'
			
			list.forEach( (article) => {
				table  += `<tr>
				<td>${article.id}</td>
				<td>${article.title}</td>
				<td>${article.content}</td>
				</tr>`
			} )
			
			table    +=	'</table>'
			return table;
		}
	</script>
	
	<script>
		// a Tag 클릭시 동작
		const aEls = document.querySelectorAll('a') // a tag 배열 리턴
		const resultEl = document.querySelector('#result')
		
		aEls.forEach( (a) => {
			a.addEventListener('click', (e) => {
				e.preventDefault();
				e.stopPropagation();
				
				let id = a.id
				let url = a.href
				console.log(a)
		//	alert(a.innerHTML)
				switch(a.id) {
				case 'getlist' : 
					alert('목록조회 클릭')
					// api controller 실행데이터 받아온다(fetch)
					fetch(a.href)
						.then( (response) => response.json() )
						.then( (list) => {							 
							
							resultEl.innerHTML = makeTable(list);
							
						} )
						.then( (error) => console.log(error) )
					break;
				}
			})
		} )
	</script>
	
</body>
</html>